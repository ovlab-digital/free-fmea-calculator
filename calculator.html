<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RPN & AP Calculator – V-LAB DIGITAL</title>

  <!-- SEO -->
  <meta name="description" content="Bereken direct RPN en Action Priority conform AIAG-VDA 2019. Gratis FMEA-calculator met live resultaat, data log en CSV export."/>
  <meta name="keywords" content="FMEA calculator, RPN, Action Priority, AIAG-VDA 2019, Severity, Occurrence, Detection, kwaliteit"/>
  <meta name="author" content="V-LAB DIGITAL"/>

  <!-- Open Graph (LinkedIn, Facebook, WhatsApp) -->
  <meta property="og:type" content="website"/>
  <meta property="og:title" content="RPN & Action Priority Calculator – V-LAB DIGITAL"/>
  <meta property="og:description" content="Gratis FMEA-calculator. Stel S, O en D in met sliders en zie RPN en AIAG-VDA 2019 Action Priority live verschijnen."/>
  <meta property="og:url" content="https://ovlab-digital.github.io/fmea-calculator/calculator.html"/>
  <meta property="og:image" content="https://ovlab-digital.github.io/fmea-calculator/preview.png"/>
  <meta property="og:locale" content="nl_NL"/>

  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet"/>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Space Grotesk',sans-serif;background:#0a0f1a;min-height:100vh;color:#fff;position:relative;overflow-x:hidden;}
    body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
      background-image:linear-gradient(rgba(14,165,233,0.03) 1px,transparent 1px),linear-gradient(90deg,rgba(14,165,233,0.03) 1px,transparent 1px);
      background-size:40px 40px;}
    .glow-1,.glow-2{position:fixed;filter:blur(80px);pointer-events:none;z-index:0;}
    .glow-1{width:400px;height:400px;top:-100px;right:-100px;background:radial-gradient(circle,rgba(14,165,233,0.2) 0%,transparent 70%);}
    .glow-2{width:300px;height:300px;bottom:100px;left:-80px;background:radial-gradient(circle,rgba(16,185,129,0.15) 0%,transparent 70%);}
    .page{max-width:780px;margin:0 auto;padding:36px 20px 60px;position:relative;z-index:1;}

    /* BANNER */
    .banner-wrap{width:100%;border-radius:14px;overflow:hidden;margin-bottom:24px;
      border:1px solid rgba(255,255,255,0.07);
      background:linear-gradient(135deg,rgba(13,20,32,0.9),rgba(26,35,50,0.8));position:relative;}
    .banner-wrap::before{content:'';position:absolute;inset:0;pointer-events:none;
      background-image:linear-gradient(rgba(14,165,233,0.04) 1px,transparent 1px),linear-gradient(90deg,rgba(14,165,233,0.04) 1px,transparent 1px);
      background-size:40px 40px;}
    .banner-inner{position:relative;z-index:1;display:flex;align-items:center;justify-content:space-between;padding:18px 26px;flex-wrap:wrap;gap:12px;}
    .banner-left{display:flex;align-items:center;gap:16px;}
    .banner-divider{width:1px;height:40px;flex-shrink:0;background:linear-gradient(180deg,transparent,rgba(14,165,233,0.3),transparent);}
    .banner-name{font-family:'JetBrains Mono',monospace;font-size:14px;font-weight:600;letter-spacing:4px;color:#14b8a6;line-height:1;margin-bottom:4px;}
    .banner-slogan{font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,0.25);}
    .banner-tag{font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:2px;color:#0EA5E9;
      text-transform:uppercase;padding:4px 10px;border:1px solid rgba(14,165,233,0.3);border-radius:4px;background:rgba(14,165,233,0.05);}

    /* PAGE TITLE */
    .page-title{margin-bottom:24px;padding:0 2px;}
    .main-title{font-size:26px;font-weight:700;letter-spacing:-0.5px;line-height:1.2;margin-bottom:3px;}
    .main-title span{background:linear-gradient(135deg,#0EA5E9,#10B981);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
    .subtitle{font-size:13px;color:rgba(255,255,255,0.35);}

    /* MAIN INPUT CARD */
    .input-card{
      border-radius:16px;padding:28px;margin-bottom:16px;
      background:linear-gradient(135deg,rgba(13,20,32,0.95),rgba(26,35,50,0.85));
      border:1px solid rgba(255,255,255,0.08);
    }

    /* NAME ROW */
    .name-row{display:flex;align-items:center;gap:12px;margin-bottom:24px;}
    .name-input{
      flex:1;padding:11px 16px;border-radius:10px;
      background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);
      color:#fff;font-family:'Space Grotesk',sans-serif;font-size:14px;outline:none;
      transition:border-color 0.2s,background 0.2s;
    }
    .name-input::placeholder{color:rgba(255,255,255,0.2);}
    .name-input:focus{border-color:rgba(14,165,233,0.5);background:rgba(14,165,233,0.04);}

    /* SLIDERS */
    .sliders-block{display:flex;flex-direction:column;gap:16px;margin-bottom:24px;}
    .slider-item{display:grid;grid-template-columns:90px 1fr 38px;align-items:center;gap:12px;}
    .slider-label{font-size:12px;color:rgba(255,255,255,0.45);display:flex;align-items:center;gap:6px;}
    .slider-tag{font-family:'JetBrains Mono',monospace;font-size:10px;padding:2px 6px;border-radius:4px;font-weight:600;}
    .tag-s{background:rgba(239,68,68,0.15);color:#f87171;}
    .tag-o{background:rgba(251,146,60,0.15);color:#fb923c;}
    .tag-d{background:rgba(99,102,241,0.15);color:#a5b4fc;}
    input[type=range]{width:100%;-webkit-appearance:none;appearance:none;height:6px;border-radius:3px;cursor:pointer;outline:none;}
    input[type=range].s-track{background:linear-gradient(to right,#4ade80,#facc15,#ef4444);}
    input[type=range].o-track{background:linear-gradient(to right,#4ade80,#facc15,#fb923c);}
    input[type=range].d-track{background:linear-gradient(to right,#4ade80,#facc15,#818cf8);}
    input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:18px;height:18px;border-radius:50%;cursor:pointer;border:2px solid #0a0f1a;}
    input[type=range].s-track::-webkit-slider-thumb{background:#f87171;}
    input[type=range].o-track::-webkit-slider-thumb{background:#fb923c;}
    input[type=range].d-track::-webkit-slider-thumb{background:#818cf8;}
    .slider-val{font-family:'JetBrains Mono',monospace;font-size:15px;font-weight:700;
      text-align:center;width:38px;}
    .val-s{color:#f87171;} .val-o{color:#fb923c;} .val-d{color:#a5b4fc;}

    /* LIVE PREVIEW BAR */
    .preview-bar{
      display:flex;align-items:center;justify-content:space-between;
      padding:14px 20px;border-radius:12px;margin-bottom:20px;
      background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.07);
      gap:12px;flex-wrap:wrap;
    }
    .preview-left{display:flex;align-items:center;gap:16px;}
    .preview-rpn{display:flex;flex-direction:column;align-items:center;}
    .rpn-number{font-family:'JetBrains Mono',monospace;font-size:28px;font-weight:700;line-height:1;}
    .rpn-number.c-high{color:#f87171;} .rpn-number.c-medium{color:#fb923c;} .rpn-number.c-low{color:#4ade80;}
    .rpn-sub{font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:1px;opacity:0.3;margin-top:2px;}
    .preview-divider{width:1px;height:36px;background:rgba(255,255,255,0.08);}
    .preview-ap{}
    .ap-pill{display:inline-block;padding:5px 14px;border-radius:20px;font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:700;letter-spacing:1px;margin-bottom:3px;}
    .ap-high{background:rgba(239,68,68,0.15);border:1px solid rgba(239,68,68,0.35);color:#f87171;}
    .ap-medium{background:rgba(251,146,60,0.15);border:1px solid rgba(251,146,60,0.35);color:#fb923c;}
    .ap-low{background:rgba(74,222,128,0.15);border:1px solid rgba(74,222,128,0.35);color:#4ade80;}
    .ap-desc{font-size:11px;color:rgba(255,255,255,0.3);}
    .preview-rationale{font-size:11px;color:rgba(255,255,255,0.35);line-height:1.5;flex:1;min-width:180px;}

    /* ADD BUTTON */
    .btn-save{
      width:100%;padding:13px;border:none;border-radius:11px;cursor:pointer;
      background:linear-gradient(135deg,#0EA5E9,#10B981);
      color:#fff;font-family:'Space Grotesk',sans-serif;font-size:14px;font-weight:600;
      letter-spacing:0.4px;transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:8px;
    }
    .btn-save:hover{opacity:0.88;transform:translateY(-1px);box-shadow:0 8px 24px rgba(14,165,233,0.25);}
    .btn-save:disabled{opacity:0.3;cursor:not-allowed;transform:none;box-shadow:none;}

    /* LOG */
    .log-card{border-radius:16px;padding:24px 28px;margin-bottom:16px;
      background:linear-gradient(135deg,rgba(13,20,32,0.9),rgba(26,35,50,0.8));
      border:1px solid rgba(255,255,255,0.07);}
    .log-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;}
    .log-title{font-family:'JetBrains Mono',monospace;font-size:10px;letter-spacing:2px;color:#0EA5E9;text-transform:uppercase;}
    .log-meta{font-family:'JetBrains Mono',monospace;font-size:10px;color:rgba(255,255,255,0.2);}
    .log-col-labels{display:grid;grid-template-columns:1fr 36px 36px 36px 54px 78px 28px;
      gap:8px;margin-bottom:8px;padding:0 2px;}
    .col-lbl{font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:1px;
      color:rgba(255,255,255,0.2);text-transform:uppercase;text-align:center;}
    .col-lbl:first-child{text-align:left;}
    #log-rows{display:flex;flex-direction:column;gap:5px;}
    .log-row{display:grid;grid-template-columns:1fr 36px 36px 36px 54px 78px 28px;
      gap:8px;align-items:center;
      background:rgba(255,255,255,0.025);border:1px solid rgba(255,255,255,0.05);
      border-radius:9px;padding:10px 12px;}
    .row-name{font-size:12px;color:rgba(255,255,255,0.7);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .row-num{font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:600;text-align:center;color:rgba(255,255,255,0.5);}
    .row-rpn{font-family:'JetBrains Mono',monospace;font-size:13px;font-weight:700;text-align:center;color:#e2e8f0;}
    .row-ap{text-align:center;font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:700;padding:3px 6px;border-radius:20px;}
    .btn-del{width:26px;height:26px;border:none;border-radius:6px;cursor:pointer;
      background:rgba(239,68,68,0.07);color:rgba(239,68,68,0.4);font-size:14px;
      display:flex;align-items:center;justify-content:center;transition:all 0.15s;}
    .btn-del:hover{background:rgba(239,68,68,0.18);color:#f87171;}
    .log-empty{text-align:center;padding:24px;font-size:11px;color:rgba(255,255,255,0.15);
      font-family:'JetBrains Mono',monospace;letter-spacing:0.5px;
      border:1px dashed rgba(255,255,255,0.07);border-radius:9px;}
    .export-row{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap;}
    .btn-export{padding:8px 16px;border-radius:8px;border:none;cursor:pointer;
      font-family:'Space Grotesk',sans-serif;font-size:12px;font-weight:600;
      transition:all 0.2s;display:flex;align-items:center;gap:6px;}
    .btn-csv{background:rgba(16,185,129,0.1);border:1px solid rgba(16,185,129,0.25);color:#10B981;}
    .btn-csv:hover{background:rgba(16,185,129,0.2);}
    .btn-clear{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);color:rgba(255,255,255,0.3);}
    .btn-clear:hover{background:rgba(255,255,255,0.07);color:rgba(255,255,255,0.55);}
    .btn-export:disabled{opacity:0.25;cursor:not-allowed;}

    /* SCORE REFERENCE */
    .score-ref-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px;}
    @media(max-width:520px){.score-ref-grid{grid-template-columns:1fr;}}
    .score-ref-col{}
    .score-ref-title{font-family:'JetBrains Mono',monospace;font-size:9px;letter-spacing:1.5px;
      text-transform:uppercase;margin-bottom:8px;display:flex;align-items:center;gap:5px;}
    .srt-s{color:#f87171;} .srt-o{color:#fb923c;} .srt-d{color:#a5b4fc;}
    .score-ref-item{display:flex;align-items:baseline;gap:7px;padding:5px 0;
      border-bottom:1px solid rgba(255,255,255,0.04);font-size:11px;color:rgba(255,255,255,0.4);}
    .score-ref-item:last-child{border-bottom:none;}
    .score-band{font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:600;
      min-width:28px;flex-shrink:0;}
    .band-low{color:#4ade80;} .band-mid{color:#fb923c;} .band-high{color:#f87171;}

    /* AP REFERENCE */
    details.ref-details summary{list-style:none;cursor:pointer;user-select:none;
      display:flex;align-items:center;justify-content:space-between;
      font-family:'JetBrains Mono',monospace;font-size:10px;letter-spacing:2px;
      color:rgba(255,255,255,0.2);text-transform:uppercase;transition:color 0.2s;}
    details.ref-details summary::-webkit-details-marker{display:none;}
    details.ref-details summary::after{content:'▼';font-size:9px;transition:transform 0.2s;}
    details.ref-details[open] summary{color:rgba(255,255,255,0.4);}
    details.ref-details[open] summary::after{transform:rotate(180deg);}
    details.ref-details summary:hover{color:rgba(255,255,255,0.45);}
    .ref-grid{display:flex;flex-direction:column;gap:8px;margin-top:16px;}
    .ref-item{display:flex;align-items:flex-start;gap:10px;font-size:12px;color:rgba(255,255,255,0.4);}

    /* FOOTER */
    .footer-bar{display:flex;justify-content:space-between;align-items:flex-end;
      padding-top:24px;border-top:1px solid rgba(255,255,255,0.05);margin-top:8px;}
    .logo{display:flex;align-items:center;gap:12px;}
    .logo-text{font-size:13px;font-weight:700;letter-spacing:1.5px;color:#fff;}
    .logo-sub{font-size:9px;color:rgba(255,255,255,0.3);letter-spacing:1px;margin-top:2px;text-transform:uppercase;}
    .footer-note{font-family:'JetBrains Mono',monospace;font-size:10px;color:rgba(255,255,255,0.15);text-align:right;}

    @media(max-width:500px){
      .slider-item{grid-template-columns:70px 1fr 34px;}
      .log-col-labels,.log-row{grid-template-columns:1fr 30px 30px 30px 46px 66px 24px;}
    }
  </style>
</head>
<body>
<div class="glow-1"></div>
<div class="glow-2"></div>
<div class="page">

  <!-- BANNER -->
  <div class="banner-wrap">
    <div class="banner-inner">
      <div class="banner-left">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 800" width="40" height="40" style="flex-shrink:0;border-radius:8px;">
          <defs><linearGradient id="vg" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" style="stop-color:#ffffff"/><stop offset="100%" style="stop-color:#14b8a6"/>
          </linearGradient></defs>
          <rect width="800" height="800" fill="#0a0f1a"/>
          <path d="M150 150 L400 650 L650 150 L550 150 L400 450 L250 150 Z" fill="url(#vg)"/>
        </svg>
        <div class="banner-divider"></div>
        <div>
          <div class="banner-name">V-LAB DIGITAL</div>
          <div class="banner-slogan">Smart Manufacturing Solutions</div>
        </div>
      </div>
      <div class="banner-tag">AIAG-VDA 2019</div>
    </div>
  </div>

  <!-- PAGE TITLE -->
  <div class="page-title">
    <h1 class="main-title">RPN & <span>Action Priority</span> Calculator</h1>
    <p class="subtitle">Process FMEA · Stel de scores in, bekijk het resultaat live en sla op in één stap.</p>
  </div>

  <!-- MAIN INPUT CARD -->
  <div class="input-card">
    <div style="font-family:'JetBrains Mono',monospace;font-size:10px;letter-spacing:2px;color:#0EA5E9;text-transform:uppercase;margin-bottom:20px;">Risk Input</div>

    <!-- Name -->
    <div class="name-row">
      <input class="name-input" id="log-name" type="text" placeholder="Omschrijf de faalwijze…" maxlength="60"/>
    </div>

    <!-- Sliders -->
    <div class="sliders-block">
      <div class="slider-item">
        <div class="slider-label"><span class="slider-tag tag-s">S</span> Severity</div>
        <input type="range" id="s-sl" class="s-track" min="1" max="10" value="5" oninput="live()"/>
        <div class="slider-val val-s" id="s-val">5</div>
      </div>
      <div class="slider-item">
        <div class="slider-label"><span class="slider-tag tag-o">O</span> Occurrence</div>
        <input type="range" id="o-sl" class="o-track" min="1" max="10" value="4" oninput="live()"/>
        <div class="slider-val val-o" id="o-val">4</div>
      </div>
      <div class="slider-item">
        <div class="slider-label"><span class="slider-tag tag-d">D</span> Detection</div>
        <input type="range" id="d-sl" class="d-track" min="1" max="10" value="3" oninput="live()"/>
        <div class="slider-val val-d" id="d-val">3</div>
      </div>
    </div>

    <!-- Score reference -->
    <details class="ref-details" style="margin-bottom:20px;">
      <summary>Score Reference — S / O / D niveaus met voorbeelden</summary>
      <div class="score-ref-grid">

        <div class="score-ref-col">
          <div class="score-ref-title srt-s">▪ Severity</div>
          <div class="score-ref-item"><span class="score-band band-low">1–2</span>Geen merkbaar effect voor de gebruiker</div>
          <div class="score-ref-item"><span class="score-band band-low">3–4</span>Klein ongemak, cosmetisch of licht functioneel</div>
          <div class="score-ref-item"><span class="score-band band-mid">5–6</span>Verminderde prestatie, klant ontevreden</div>
          <div class="score-ref-item"><span class="score-band band-high">7–8</span>Systeem werkt beperkt, hoge ontevredenheid</div>
          <div class="score-ref-item"><span class="score-band band-high">9–10</span>Veiligheids- of regelgevingsrisico, gevaar voor gebruiker</div>
        </div>

        <div class="score-ref-col">
          <div class="score-ref-title srt-o">▪ Occurrence</div>
          <div class="score-ref-item"><span class="score-band band-low">1–2</span>Vrijwel onmogelijk (&lt; 1 op 1.000.000)</div>
          <div class="score-ref-item"><span class="score-band band-low">3–4</span>Laag (1 op 10.000 – 1 op 100.000)</div>
          <div class="score-ref-item"><span class="score-band band-mid">5–6</span>Matig (1 op 1.000 – 1 op 10.000)</div>
          <div class="score-ref-item"><span class="score-band band-high">7–8</span>Hoog (1 op 20 – 1 op 1.000)</div>
          <div class="score-ref-item"><span class="score-band band-high">9–10</span>Zeer hoog (&gt; 1 op 10 producties)</div>
        </div>

        <div class="score-ref-col">
          <div class="score-ref-title srt-d">▪ Detection</div>
          <div class="score-ref-item"><span class="score-band band-low">1–2</span>Vrijwel zeker gedetecteerd, foutveilig systeem</div>
          <div class="score-ref-item"><span class="score-band band-low">3–4</span>Hoge kans op detectie via beheersmaatregelen</div>
          <div class="score-ref-item"><span class="score-band band-mid">5–6</span>Matige kans, handmatige inspectie vereist</div>
          <div class="score-ref-item"><span class="score-band band-high">7–8</span>Lage kans, fout moeilijk te onderscheppen</div>
          <div class="score-ref-item"><span class="score-band band-high">9–10</span>Geen detectie mogelijk, fout bereikt klant</div>
        </div>

      </div>
    </details>

    <!-- Live preview -->
    <div class="preview-bar">
      <div class="preview-left">
        <div class="preview-rpn">
          <div class="rpn-number" id="rpn-num">60</div>
          <div class="rpn-sub">RPN</div>
        </div>
        <div class="preview-divider"></div>
        <div class="preview-ap">
          <div class="ap-pill" id="ap-pill">MEDIUM</div>
          <div class="ap-desc" id="ap-desc">Action recommended</div>
        </div>
      </div>
      <div class="preview-rationale" id="rationale"></div>
    </div>

    <!-- Save button -->
    <button class="btn-save" id="btn-save" onclick="addRow()">
      <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 5v14m-7-7h14"/>
      </svg>
      Opslaan in log
    </button>
  </div>

  <!-- LOG CARD -->
  <div class="log-card">
    <div class="log-header">
      <div class="log-title">Log</div>
      <div class="log-meta" id="log-count">0 / 5</div>
    </div>
    <div class="log-col-labels">
      <div class="col-lbl">Faalwijze</div>
      <div class="col-lbl">S</div><div class="col-lbl">O</div><div class="col-lbl">D</div>
      <div class="col-lbl">RPN</div><div class="col-lbl">AP</div><div class="col-lbl"></div>
    </div>
    <div id="log-rows">
      <div class="log-empty">Nog geen regels — voeg een faalwijze toe hierboven</div>
    </div>
    <div class="export-row">
      <button class="btn-export btn-csv" id="btn-csv" onclick="exportCSV()" disabled>
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1M12 12v9m0 0l-3-3m3 3l3-3M8 8V4h8v4"/>
        </svg>
        Export CSV
      </button>
      <button class="btn-export btn-clear" id="btn-clear" onclick="clearLog()" disabled>Clear all</button>
    </div>
  </div>

  <!-- AP REFERENCE -->
  <div class="log-card">
    <details class="ref-details">
      <summary>AP Logic Reference — AIAG-VDA 2019</summary>
      <div class="ref-grid">
        <div class="ref-item">
          <span class="ap-pill ap-high" style="font-size:9px;padding:2px 8px;white-space:nowrap;flex-shrink:0;">HIGH</span>
          <span>S ≥ 9 &nbsp;OR&nbsp; (S ≥ 5 AND O ≥ 4) &nbsp;OR&nbsp; (O ≥ 5 AND D ≥ 5) — Immediate action required</span>
        </div>
        <div class="ref-item">
          <span class="ap-pill ap-medium" style="font-size:9px;padding:2px 8px;white-space:nowrap;flex-shrink:0;">MEDIUM</span>
          <span>(S ≥ 4 AND O ≥ 3) &nbsp;OR&nbsp; (O ≥ 4 AND D ≥ 3) &nbsp;OR&nbsp; RPN ≥ 100 — Action recommended</span>
        </div>
        <div class="ref-item">
          <span class="ap-pill ap-low" style="font-size:9px;padding:2px 8px;white-space:nowrap;flex-shrink:0;">LOW</span>
          <span>All other combinations — low risk, monitor periodically</span>
        </div>
      </div>
    </details>
  </div>

  <!-- FOOTER -->
  <div class="footer-bar">
    <div class="logo">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 800" width="36" height="36" style="border-radius:8px;flex-shrink:0;">
        <defs><linearGradient id="vg2" x1="0%" y1="0%" x2="100%" y2="0%">
          <stop offset="0%" style="stop-color:#ffffff"/><stop offset="100%" style="stop-color:#14b8a6"/>
        </linearGradient></defs>
        <rect width="800" height="800" fill="#0a0f1a"/>
        <path d="M150 150 L400 650 L650 150 L550 150 L400 450 L250 150 Z" fill="url(#vg2)"/>
      </svg>
      <div>
        <div class="logo-text">V-LAB DIGITAL</div>
        <div class="logo-sub">Smart Manufacturing Solutions</div>
      </div>
    </div>
    <div class="footer-note">FMEA SUITE<br/>AIAG-VDA 2019</div>
  </div>

</div>
<script>
  var logData = [];
  var MAX = 5;

  function clamp(v){ return Math.min(10,Math.max(1,isNaN(v)?1:v)); }

  function getAP(s,o,d){
    if(s>=9||(s>=5&&o>=4)||(o>=5&&d>=5)) return 'HIGH';
    if((s>=4&&o>=3)||(o>=4&&d>=3)||s*o*d>=100) return 'MEDIUM';
    return 'LOW';
  }
  function apClass(ap){ return ap==='HIGH'?'ap-high':ap==='MEDIUM'?'ap-medium':'ap-low'; }
  function apShort(ap){ return ap==='HIGH'?'Directe actie vereist':ap==='MEDIUM'?'Actie aanbevolen':'Monitor & review'; }
  function getRationale(s,o,d,ap){
    if(ap==='HIGH'){
      if(s>=9) return 'S='+s+' ≥ 9 — Kritieke ernst, directe actie vereist.';
      if(s>=5&&o>=4) return 'S='+s+' ≥ 5 én O='+o+' ≥ 4 — Hoge ernst met merkbare frequentie.';
      return 'O='+o+' ≥ 5 én D='+d+' ≥ 5 — Hoge frequentie met zwakke detectie.';
    }
    if(ap==='MEDIUM'){
      if(s*o*d>=100) return 'RPN='+(s*o*d)+' ≥ 100 — Gecombineerd risico overschrijdt drempelwaarde.';
      if(s>=4&&o>=3) return 'S='+s+' én O='+o+' wijzen op matig risico — procesverbetering aanbevolen.';
      return 'O='+o+' én D='+d+' suggereren detectieleemte — review het controleplan.';
    }
    return 'S='+s+', O='+o+', D='+d+' — Scores binnen acceptabel bereik.';
  }

  function live(){
    var s = parseInt(document.getElementById('s-sl').value);
    var o = parseInt(document.getElementById('o-sl').value);
    var d = parseInt(document.getElementById('d-sl').value);
    var rpn = s*o*d;
    var ap  = getAP(s,o,d);
    var cls = apClass(ap);

    document.getElementById('s-val').textContent = s;
    document.getElementById('o-val').textContent = o;
    document.getElementById('d-val').textContent = d;

    var rpnEl = document.getElementById('rpn-num');
    rpnEl.textContent = rpn;
    rpnEl.className   = 'rpn-number c-'+ap.toLowerCase();

    var pill = document.getElementById('ap-pill');
    pill.textContent  = 'AP: '+ap;
    pill.className    = 'ap-pill '+cls;

    document.getElementById('ap-desc').textContent    = apShort(ap);
    document.getElementById('rationale').textContent  = getRationale(s,o,d,ap);
  }

  function addRow(){
    if(logData.length >= MAX) return;
    var name = document.getElementById('log-name').value.trim() || 'Naamloze faalwijze';
    var s = parseInt(document.getElementById('s-sl').value);
    var o = parseInt(document.getElementById('o-sl').value);
    var d = parseInt(document.getElementById('d-sl').value);
    logData.push({id:Date.now(),name:name,s:s,o:o,d:d,rpn:s*o*d,ap:getAP(s,o,d)});
    document.getElementById('log-name').value = '';
    document.getElementById('log-name').focus();
    renderLog();
  }

  function deleteRow(id){
    logData = logData.filter(function(r){ return r.id!==id; });
    renderLog();
  }

  function clearLog(){
    if(!confirm('Alle log-regels verwijderen?')) return;
    logData=[];
    renderLog();
  }

  function renderLog(){
    document.getElementById('log-count').textContent = logData.length+' / '+MAX;
    document.getElementById('btn-save').disabled  = logData.length >= MAX;
    document.getElementById('btn-csv').disabled   = logData.length === 0;
    document.getElementById('btn-clear').disabled = logData.length === 0;
    var c = document.getElementById('log-rows');
    if(logData.length===0){
      c.innerHTML='<div class="log-empty">Nog geen regels — voeg een faalwijze toe hierboven</div>';
      return;
    }
    c.innerHTML = logData.map(function(r){
      return '<div class="log-row">'+
        '<div class="row-name" title="'+r.name+'">'+r.name+'</div>'+
        '<div class="row-num">'+r.s+'</div>'+
        '<div class="row-num">'+r.o+'</div>'+
        '<div class="row-num">'+r.d+'</div>'+
        '<div class="row-rpn">'+r.rpn+'</div>'+
        '<div class="row-ap '+apClass(r.ap)+'">'+r.ap+'</div>'+
        '<button class="btn-del" onclick="deleteRow('+r.id+')">×</button>'+
      '</div>';
    }).join('');
  }

  function exportCSV(){
    if(!logData.length) return;
    var h = 'Failure Mode;Severity (S);Occurrence (O);Detection (D);RPN;Action Priority';
    var rows = logData.map(function(r){ return '"'+r.name+'";'+r.s+';'+r.o+';'+r.d+';'+r.rpn+';'+r.ap; });
    var csv = '\uFEFF' + [h].concat(rows).join('\n');
    var blob = new Blob([csv],{type:'text/csv;charset=utf-8;'});
    var url = URL.createObjectURL(blob);
    var a = document.createElement('a');
    a.href = url;
    a.download = 'FMEA_'+new Date().toISOString().slice(0,10)+'.csv';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }

  live();
  renderLog();
</script>
</body>
</html>
